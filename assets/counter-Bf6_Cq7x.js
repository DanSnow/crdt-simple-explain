import{j as r,r as f}from"./index-Bk1QCUzH.js";import{g as U,S as E,a as k,o as R,l as P,h as O,d as g,e as _,R as D,i as I,f as A}from"./schemas-X-CVU6ni.js";const p=n=>typeof n=="boolean"?`${n}`:n===0?"0":n,b=U,j=(n,e)=>t=>{var l;if(e?.variants==null)return b(n,t?.class,t?.className);const{variants:u,defaultVariants:i}=e,V=Object.keys(u).map(s=>{const o=t?.[s],c=i?.[s];if(o===null)return null;const a=p(o)||p(c);return u[s][a]}),h=t&&Object.entries(t).reduce((s,o)=>{let[c,a]=o;return a===void 0||(s[c]=a),s},{}),N=e==null||(l=e.compoundVariants)===null||l===void 0?void 0:l.reduce((s,o)=>{let{class:c,className:a,...S}=o;return Object.entries(S).every(z=>{let[m,v]=z;return Array.isArray(v)?v.includes({...i,...h}[m]):{...i,...h}[m]===v})?[...s,c,a]:s},[]);return b(n,V,N,t?.class,t?.className)},B=j("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}});function x({className:n,variant:e,size:t,asChild:l=!1,...u}){const i=l?E:"button";return r.jsx(i,{"data-slot":"button",className:k(B({variant:e,size:t,className:n})),...u})}const G=j("flex w-fit items-stretch [&>*]:focus-visible:z-10 [&>*]:focus-visible:relative [&>[data-slot=select-trigger]:not([class*='w-'])]:w-fit [&>input]:flex-1 has-[select[aria-hidden=true]:last-child]:[&>[data-slot=select-trigger]:last-of-type]:rounded-r-md has-[>[data-slot=button-group]]:gap-2",{variants:{orientation:{horizontal:"[&>*:not(:first-child)]:rounded-l-none [&>*:not(:first-child)]:border-l-0 [&>*:not(:last-child)]:rounded-r-none",vertical:"flex-col [&>*:not(:first-child)]:rounded-t-none [&>*:not(:first-child)]:border-t-0 [&>*:not(:last-child)]:rounded-b-none"}},defaultVariants:{orientation:"horizontal"}});function L({className:n,orientation:e,...t}){return r.jsx("div",{role:"group","data-slot":"button-group","data-orientation":e,className:k(G({orientation:e}),n),...t})}class T{existsEvent=new Set;events=[];listeners=new Set;increment(){this.push({id:crypto.randomUUID(),action:"inc"})}decrease(){this.push({id:crypto.randomUUID(),action:"dec"})}push(e){if(!this.existsEvent.has(e.id)){this.existsEvent.add(e.id),this.events.push(e);for(const t of this.listeners)t(e)}}onUpdate(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}toValue(){return this.events.reduce((e,{action:t})=>e+(t==="inc"?1:-1),0)}}const d=new T,W=R({id:O(),action:P(["inc","dec"])}),F=g.router({publish:g.input(W)}),w=new SharedWorker(new URL("/crdt-simple-explain/assets/sync-worker.worker-DdRYnTQF.js",import.meta.url),{type:"module"}),C=w.port,H=new D({port:w.port}),K=_(H),y=I(F),Q=y.router({publish:y.publish.handler(({input:n})=>{console.log("receive",n),d.push(n)})}),Y=new A(Q);Y.upgrade(C);C.start();function $(){const n=f.useSyncExternalStore(e=>d.onUpdate(e),()=>d.toValue());return f.useEffect(()=>{d.onUpdate(e=>{K.publish(e)})},[]),r.jsx("div",{className:"p-8",children:r.jsxs("div",{className:"flex items-center flex-col justify-center",children:[r.jsx("output",{className:"text-4xl p-4 font-bold",children:n}),r.jsxs(L,{children:[r.jsx(x,{onClick:()=>d.increment(),children:"+1"}),r.jsx(x,{onClick:()=>d.decrease(),children:"-1"})]})]})})}function M(){return r.jsx($,{})}export{M as component};
